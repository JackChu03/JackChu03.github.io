<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jack Chu">

<title>Pokemon Machine Learning Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Pokemon Final Project_files/libs/clipboard/clipboard.min.js"></script>
<script src="Pokemon Final Project_files/libs/quarto-html/quarto.js"></script>
<script src="Pokemon Final Project_files/libs/quarto-html/popper.min.js"></script>
<script src="Pokemon Final Project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Pokemon Final Project_files/libs/quarto-html/anchor.min.js"></script>
<link href="Pokemon Final Project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Pokemon Final Project_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Pokemon Final Project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Pokemon Final Project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Pokemon Final Project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#visualization-work-for-pokémon-dataset-and-pokémon-combat-dataset" id="toc-visualization-work-for-pokémon-dataset-and-pokémon-combat-dataset" class="nav-link active" data-scroll-target="#visualization-work-for-pokémon-dataset-and-pokémon-combat-dataset">Visualization Work for Pokémon dataset and Pokémon Combat dataset</a></li>
  <li><a href="#data-processing-forming-variables" id="toc-data-processing-forming-variables" class="nav-link" data-scroll-target="#data-processing-forming-variables">Data Processing &amp; Forming Variables</a></li>
  <li><a href="#logistic-regression-model-fitting" id="toc-logistic-regression-model-fitting" class="nav-link" data-scroll-target="#logistic-regression-model-fitting">Logistic Regression Model Fitting</a></li>
  <li><a href="#random-forest-model-fitting" id="toc-random-forest-model-fitting" class="nav-link" data-scroll-target="#random-forest-model-fitting">Random Forest Model Fitting</a></li>
  <li><a href="#xgboost-model-fitting" id="toc-xgboost-model-fitting" class="nav-link" data-scroll-target="#xgboost-model-fitting">XGBoost Model Fitting</a></li>
  <li><a href="#bagging-model-fitting" id="toc-bagging-model-fitting" class="nav-link" data-scroll-target="#bagging-model-fitting">Bagging Model Fitting</a></li>
  <li><a href="#roc-auc-comparison-between-logistic-regression-random-forest-xgboost-and-bagging" id="toc-roc-auc-comparison-between-logistic-regression-random-forest-xgboost-and-bagging" class="nav-link" data-scroll-target="#roc-auc-comparison-between-logistic-regression-random-forest-xgboost-and-bagging">ROC/ AUC Comparison between Logistic Regression, Random Forest, XGBoost and Bagging</a></li>
  <li><a href="#feature-variable-importance-plots" id="toc-feature-variable-importance-plots" class="nav-link" data-scroll-target="#feature-variable-importance-plots">Feature (Variable) Importance Plots</a></li>
  <li><a href="#radar-chart" id="toc-radar-chart" class="nav-link" data-scroll-target="#radar-chart">Radar Chart</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Pokemon Machine Learning Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jack Chu</p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="visualization-work-for-pokémon-dataset-and-pokémon-combat-dataset" class="level2">
<h2 class="anchored" data-anchor-id="visualization-work-for-pokémon-dataset-and-pokémon-combat-dataset">Visualization Work for Pokémon dataset and Pokémon Combat dataset</h2>
<p>First we read in the Pokémon dataset and create a visualization to better understand the number of Pokémons in each type, we find out that the types Water, Normal, Grass have the most Pokémons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pokemon<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"~/Downloads/pokemon.csv"</span>,<span class="at">sep=</span><span class="st">","</span>,<span class="at">stringsAsFactors=</span>F)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pokemon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "X."         "Name"       "Type.1"     "Type.2"     "HP"        
 [6] "Attack"     "Defense"    "Sp..Atk"    "Sp..Def"    "Speed"     
[11] "Generation" "Legendary" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pokemon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       X.            Name              Type.1             Type.2         
 Min.   :  1.0   Length:800         Length:800         Length:800        
 1st Qu.:200.8   Class :character   Class :character   Class :character  
 Median :400.5   Mode  :character   Mode  :character   Mode  :character  
 Mean   :400.5                                                           
 3rd Qu.:600.2                                                           
 Max.   :800.0                                                           
       HP             Attack       Defense          Sp..Atk      
 Min.   :  1.00   Min.   :  5   Min.   :  5.00   Min.   : 10.00  
 1st Qu.: 50.00   1st Qu.: 55   1st Qu.: 50.00   1st Qu.: 49.75  
 Median : 65.00   Median : 75   Median : 70.00   Median : 65.00  
 Mean   : 69.26   Mean   : 79   Mean   : 73.84   Mean   : 72.82  
 3rd Qu.: 80.00   3rd Qu.:100   3rd Qu.: 90.00   3rd Qu.: 95.00  
 Max.   :255.00   Max.   :190   Max.   :230.00   Max.   :194.00  
    Sp..Def          Speed          Generation     Legendary        
 Min.   : 20.0   Min.   :  5.00   Min.   :1.000   Length:800        
 1st Qu.: 50.0   1st Qu.: 45.00   1st Qu.:2.000   Class :character  
 Median : 70.0   Median : 65.00   Median :3.000   Mode  :character  
 Mean   : 71.9   Mean   : 68.28   Mean   :3.324                     
 3rd Qu.: 90.0   3rd Qu.: 90.00   3rd Qu.:5.000                     
 Max.   :230.0   Max.   :180.00   Max.   :6.000                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pokemon <span class="ot">&lt;-</span> <span class="fu">within</span>(pokemon, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                  Type<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">factor</span>(Type<span class="fl">.1</span>, <span class="at">levels=</span><span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(Type<span class="fl">.1</span>), </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">decreasing=</span><span class="cn">TRUE</span>))))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>color<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"#6F35FC"</span>,<span class="st">"#B7B7CE"</span>,<span class="st">"#A98FF3"</span>,<span class="st">"#F95587"</span>,<span class="st">"#B6A136"</span>,<span class="st">"#EE8130"</span>,<span class="st">"#F7D02C"</span>,<span class="st">"#705746"</span>,<span class="st">"#735797"</span>,<span class="st">"#E2BF65"</span>,<span class="st">"#96D9D6"</span>,<span class="st">"#6390F0"</span>,<span class="st">"#7AC74C"</span>,<span class="st">"#C22E28"</span>,<span class="st">"#D685AD"</span>,<span class="st">"#A33EA1"</span>,<span class="st">"#A8A77A"</span>,<span class="st">"#A6B91A"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pokemon, <span class="fu">aes</span>(<span class="at">x=</span>Type<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"count"</span>, <span class="at">fill=</span>color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Then we read in the Pokémon combat dataset. From this dataset, we can only see the id of the winner and loser Pokémon, so we try to extract the features info such as correct name, the attack points, speed… of the Winner/ Loser Pokémon from the Pokémon dataset and comfine all those with the combat dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>combats<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">'~/Downloads/combats.csv'</span>,<span class="at">sep=</span><span class="st">","</span>,<span class="at">stringsAsFactors=</span>F)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> pokemon <span class="sc">%&gt;%</span> <span class="fu">select</span>(X., Name)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Find names</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>First_pokemon_name<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>First_pokemon, <span class="cf">function</span>(x) names<span class="sc">$</span>Name[<span class="fu">match</span>(x, names<span class="sc">$</span>X.)])</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Second_pokemon_name<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Second_pokemon, <span class="cf">function</span>(x) names<span class="sc">$</span>Name[<span class="fu">match</span>(x, names<span class="sc">$</span>X.)])</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Winner_name<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Winner, <span class="cf">function</span>(x) names<span class="sc">$</span>Name[<span class="fu">match</span>(x, names<span class="sc">$</span>X.)])</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>loser<span class="ot">&lt;-</span><span class="fu">ifelse</span>(combats<span class="sc">$</span>Winner<span class="sc">==</span>combats<span class="sc">$</span>First_pokemon,combats<span class="sc">$</span>Second_pokemon,combats<span class="sc">$</span>First_pokemon)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Loser_name<span class="ot">&lt;-</span><span class="fu">sapply</span>(loser, <span class="cf">function</span>(x) names<span class="sc">$</span>Name[<span class="fu">match</span>(x, names<span class="sc">$</span>X.)])</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Combine features from Pokemon dataset with combat dataset</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Winner_attack<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Winner_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Attack[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Loser_attack<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Loser_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Attack[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Winner_HP<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Winner_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>HP[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Loser_HP<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Loser_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>HP[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Winner_defense<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Winner_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Defense[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Loser_defense<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Loser_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Defense[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Winner_sp_atk<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Winner_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Sp..Atk[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Loser_sp_atk<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Loser_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Sp..Atk[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Winner_sp_def<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Winner_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Sp..Def[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Loser_sp_def<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Loser_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Sp..Def[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Winner_speed<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Winner_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Speed[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Loser_speed<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Loser_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Speed[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Winner_Generation<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Winner_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Generation[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Loser_Generation<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Loser_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Generation[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Winner_Type<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Winner_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Type<span class="fl">.1</span>[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Loser_Type<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Loser_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Type<span class="fl">.1</span>[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We would like to first calculate the differences between all the numeric competence features between the winner Pokémon and the loser Pokémon.</p>
<p>Second, we create a new variable which includes the info about whether the winner Pokémon has type advantage over the loser Pokémon or not. If yes, then we assign 1, if not, the value remains 0. However, if the winner Pokémon has type disadvantage with the loser Pokémon, we assign -1.</p>
<p>We also incude the variable “if the winner Pokémon is legendary or not”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_atk <span class="ot">&lt;-</span> combats<span class="sc">$</span>Winner_attack <span class="sc">-</span> combats<span class="sc">$</span>Loser_attack</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_def <span class="ot">&lt;-</span> combats<span class="sc">$</span>Winner_defense <span class="sc">-</span> combats<span class="sc">$</span>Loser_defense</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_sp_atk <span class="ot">&lt;-</span> combats<span class="sc">$</span>Winner_sp_atk <span class="sc">-</span> combats<span class="sc">$</span>Loser_sp_atk</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_sp_def <span class="ot">&lt;-</span> combats<span class="sc">$</span>Winner_sp_def <span class="sc">-</span> combats<span class="sc">$</span>Loser_sp_def</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_speed <span class="ot">&lt;-</span> combats<span class="sc">$</span>Winner_speed <span class="sc">-</span> combats<span class="sc">$</span>Loser_speed</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_HP <span class="ot">&lt;-</span> combats<span class="sc">$</span>Winner_HP <span class="sc">-</span> combats<span class="sc">$</span>Loser_HP</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_Gen <span class="ot">&lt;-</span> combats<span class="sc">$</span>Winner_Generation <span class="sc">-</span> combats<span class="sc">$</span>Loser_Generation</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#2</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(combats<span class="sc">$</span>diff_atk))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Normal"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Rock"</span>, <span class="st">"Steel"</span>, <span class="st">"Ghost"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Fighting"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">'Normal'</span>, <span class="st">"Rock"</span>, <span class="st">"Steel"</span>, <span class="st">"Ice"</span>, <span class="st">"Dark"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Fighting"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Flying"</span>, <span class="st">"Poison"</span>, <span class="st">"Bug"</span>, <span class="st">"Psychic"</span>, <span class="st">"Ghost"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Flying"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Bug"</span>, <span class="st">"Grass"</span>, <span class="st">"Fairy"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Flying"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Rock"</span>, <span class="st">"Steel"</span>, <span class="st">"Electric"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Poison"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Grass"</span>, <span class="st">"Fairy"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Poison"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Ground"</span>, <span class="st">"Rock"</span>, <span class="st">"Ghost"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Ground"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">"Poison"</span>, <span class="st">"Rock"</span>, <span class="st">"Steel"</span>, <span class="st">"Fire"</span>, <span class="st">"Electric"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Ground"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Bug"</span>, <span class="st">"Grass"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Rock"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Flying"</span>, <span class="st">"Bug"</span>, <span class="st">"Fire"</span>, <span class="st">"Ice"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Rock"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Ground"</span>, <span class="st">"Steel"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Bug"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Grass"</span>, <span class="st">"Psychic"</span>, <span class="st">"Dark"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Bug"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Flying"</span>, <span class="st">"Poison"</span>, <span class="st">"Ghost"</span>, <span class="st">"Steel"</span>, </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Fire"</span>, <span class="st">"Fairy"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Ghost"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Psychic"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Ghost"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Dark"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Steel"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Rock"</span>, <span class="st">"Ice"</span>, <span class="st">"Fairy"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Steel"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fire"</span>, <span class="st">"Water"</span>, <span class="st">"Electric"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Fire"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Bug"</span>, <span class="st">"Steel"</span>, <span class="st">"Grass"</span>, <span class="st">"Ice"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Fire"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Rock"</span>, <span class="st">"Water"</span>, <span class="st">"Dragon"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Ground"</span>, <span class="st">"Rock"</span>, <span class="st">"Fire"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Grass"</span>, <span class="st">"Dragon"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Grass"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Ground"</span>, <span class="st">"Rock"</span>, <span class="st">"Water"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Grass"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Flying"</span>, <span class="st">"Poison"</span>, <span class="st">"Bug"</span>, <span class="st">"Steel"</span>, <span class="st">"Fire"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Electric"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Flying"</span>, <span class="st">"Water"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Electric"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="st">"Ground"</span>, <span class="st">"Grass"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Psychic"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Poison"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Psychic"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="st">"Steel"</span>, <span class="st">"Dark"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Ice"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Flying"</span>, <span class="st">"Ground"</span>, <span class="st">"Grass"</span>, <span class="st">"Dragon"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Ice"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="st">'Steel'</span>, <span class="st">'Fire'</span>, <span class="st">'Water'</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Dragon"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Steel"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Dark"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="st">"Ghost"</span>, <span class="st">"Psychic"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Dark"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Fairy"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Fairy"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Dragon"</span>, <span class="st">"Dark"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Fairy"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Loser_Type <span class="sc">%in%</span> </span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="st">"Poison"</span>, <span class="st">"Steel"</span>, <span class="st">"Fire"</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>winner_legendary<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Winner_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Legendary[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s about time for us to take a look into the potential winning factor by creating some density plots and bar charts.</p>
<ol type="1">
<li>From this viz, we find out that winner Pokémon do have more positive attack points difference than the negative, meaing it could be a potential factor to winning the battle. However, generally, the winner Pokémons do not all have relatively strong attack points over the loser Pokémon.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combats, <span class="fu">aes</span>(<span class="at">x=</span>combats<span class="sc">$</span>diff_atk))<span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#E69F00"</span>, <span class="at">alpha=</span>.<span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `combats$diff_atk` is discouraged.
ℹ Use `diff_atk` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="2" type="1">
<li>This viz is similar to the first one. Special attack points could be a potential factor but there are still lots of negative special attack points differences form the loser Pokémon for the winner Pokémon.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combats, <span class="fu">aes</span>(<span class="at">x=</span>combats<span class="sc">$</span>diff_sp_atk))<span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#E69F00"</span>, <span class="at">alpha=</span>.<span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `combats$diff_sp_atk` is discouraged.
ℹ Use `diff_sp_atk` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="3" type="1">
<li>From this viz, we can tell generation difference between two Pokémons is probably not that crucial to win a battle.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(combats<span class="sc">$</span>diff_Gen, <span class="at">col=</span><span class="st">"#E69F00"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="4" type="1">
<li>From this viz, we can also tell hp difference between two Pokémons is probably not that crucial to win a battle as well.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combats, <span class="fu">aes</span>(<span class="at">x=</span>combats<span class="sc">$</span>diff_HP))<span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#E69F00"</span>, <span class="at">alpha=</span>.<span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `combats$diff_HP` is discouraged.
ℹ Use `diff_HP` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="4" type="1">
<li>Now, from this speed difference viz, we find out that if one Pokémon has higher speed than the other one, it has more chances to win the battle.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combats, <span class="fu">aes</span>(<span class="at">x=</span>combats<span class="sc">$</span>diff_speed))<span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#E69F00"</span>, <span class="at">alpha=</span>.<span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `combats$diff_speed` is discouraged.
ℹ Use `diff_speed` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="5" type="1">
<li>From this viz, we believe type difference between two Pokémons could play a factor to winning the battle but not that crucial.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combats) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> combats<span class="sc">$</span>strong), <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Strong VS (Winner)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `combats$strong` is discouraged.
ℹ Use `strong` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(combats<span class="sc">$</span>strong)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   -1     0     1 
 6921 35261  7818 </code></pre>
</div>
</div>
<ol start="6" type="1">
<li>From this viz, we can see there are still a great number of outcomes showing winner Pokémon is a legendary one. It could be a important factor.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combats) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> combats<span class="sc">$</span>winner_legendary), <span class="at">fill =</span> <span class="st">"gold"</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Winner Lengendary"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `combats$winner_legendary` is discouraged.
ℹ Use `winner_legendary` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(combats<span class="sc">$</span>winner_legendary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
False  True 
43623  6377 </code></pre>
</div>
</div>
</section>
<section id="data-processing-forming-variables" class="level2">
<h2 class="anchored" data-anchor-id="data-processing-forming-variables">Data Processing &amp; Forming Variables</h2>
<p>Read in the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>pokemon<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"~/Downloads/pokemon.csv"</span>,<span class="at">sep=</span><span class="st">","</span>,<span class="at">stringsAsFactors=</span>F)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>combats<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">'~/Downloads/combats.csv'</span>,<span class="at">sep=</span><span class="st">","</span>,<span class="at">stringsAsFactors=</span>F)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> pokemon <span class="sc">%&gt;%</span> <span class="fu">select</span>(X., Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Combine Pokemon dataset and Combat dataset to generate features for First Pokemon and Second Pokemon. Also, create variables of feature difference between first Pokemon and second Pokemon by using the first minus the second and some using the proportion of the two Pokemon’s features. We then put type difference into consideration and created two variables: strong and weak, they represent whether a certain type of Pokemon has advantage/ disadvantage over the other certain type of Pokemon. Finally, we used if the Pokemon is legendary or not as a variable. The dependent variable we used is if_first_wins, which represents if the first Pokemon wins the battle or not, if Yes, we assign 1 and 0 for No.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find names</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>First_pokemon_name<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>First_pokemon, <span class="cf">function</span>(x) names<span class="sc">$</span>Name[<span class="fu">match</span>(x, names<span class="sc">$</span>X.)])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Second_pokemon_name<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Second_pokemon, <span class="cf">function</span>(x) names<span class="sc">$</span>Name[<span class="fu">match</span>(x, names<span class="sc">$</span>X.)])</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Dependent variable</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>if_first_win<span class="ot">&lt;-</span><span class="fu">ifelse</span>(combats<span class="sc">$</span>Winner<span class="sc">==</span>combats<span class="sc">$</span>First_pokemon,<span class="st">'yes'</span>,<span class="st">'no'</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>if_first_win[combats<span class="sc">$</span>if_first_win <span class="sc">==</span> <span class="st">"no"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>if_first_win[combats<span class="sc">$</span>if_first_win <span class="sc">==</span> <span class="st">"yes"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>if_first_win <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(combats<span class="sc">$</span>if_first_win)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># First Pokemon &amp; Second Pikemon's features</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>First_attack<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>First_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Attack[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Second_attack<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Second_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Attack[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_atk <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_attack <span class="sc">-</span> combats<span class="sc">$</span>Second_attack</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>First_HP<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>First_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>HP[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Second_HP<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Second_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>HP[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_HP <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_HP <span class="sc">-</span> combats<span class="sc">$</span>Second_HP</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>prop_HP <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_HP <span class="sc">/</span> combats<span class="sc">$</span>Second_HP</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>First_defense<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>First_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Defense[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Second_defense<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Second_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Defense[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_def <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_defense <span class="sc">-</span> combats<span class="sc">$</span>Second_defense</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>First_sp_atk<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>First_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Sp..Atk[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Second_sp_atk<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Second_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Sp..Atk[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_sp_atk <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_sp_atk <span class="sc">-</span> combats<span class="sc">$</span>Second_sp_atk</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>First_sp_def<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>First_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Sp..Def[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Second_sp_def<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Second_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Sp..Def[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_sp_def <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_sp_def <span class="sc">-</span> combats<span class="sc">$</span>Second_sp_def</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>First_speed<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>First_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Speed[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Second_speed<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Second_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Speed[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>diff_speed <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_speed <span class="sc">-</span> combats<span class="sc">$</span>Second_speed</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>prop_speed <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_speed <span class="sc">/</span> combats<span class="sc">$</span>Second_speed</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>First_Type<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>First_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Type<span class="fl">.1</span>[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>Second_Type<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Second_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Type<span class="fl">.1</span>[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(combats<span class="sc">$</span>diff_atk))</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(combats<span class="sc">$</span>diff_atk))</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Normal"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Rock"</span>, <span class="st">"Steel"</span>, <span class="st">"Ghost"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Fighting"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">'Normal'</span>, <span class="st">"Rock"</span>, <span class="st">"Steel"</span>, <span class="st">"Ice"</span>, <span class="st">"Dark"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Fighting"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Flying"</span>, <span class="st">"Poison"</span>, <span class="st">"Bug"</span>, <span class="st">"Psychic"</span>, <span class="st">"Ghost"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Flying"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Bug"</span>, <span class="st">"Grass"</span>, <span class="st">"Fairy"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>Winner_Type <span class="sc">==</span> <span class="st">"Flying"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Rock"</span>, <span class="st">"Steel"</span>, <span class="st">"Electric"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Poison"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Grass"</span>, <span class="st">"Fairy"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Poison"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Ground"</span>, <span class="st">"Rock"</span>, <span class="st">"Ghost"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Ground"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Poison"</span>, <span class="st">"Rock"</span>, <span class="st">"Steel"</span>, <span class="st">"Fire"</span>, <span class="st">"Electric"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Ground"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Bug"</span>, <span class="st">"Grass"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Rock"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Flying"</span>, <span class="st">"Bug"</span>, <span class="st">"Fire"</span>, <span class="st">"Ice"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Rock"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Ground"</span>, <span class="st">"Steel"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Bug"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Grass"</span>, <span class="st">"Psychic"</span>, <span class="st">"Dark"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Bug"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Flying"</span>, <span class="st">"Poison"</span>, <span class="st">"Ghost"</span>, <span class="st">"Steel"</span>, </span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Fire"</span>, <span class="st">"Fairy"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Ghost"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Psychic"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Ghost"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Dark"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Steel"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Rock"</span>, <span class="st">"Ice"</span>, <span class="st">"Fairy"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Steel"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fire"</span>, <span class="st">"Water"</span>, <span class="st">"Electric"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Fire"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Bug"</span>, <span class="st">"Steel"</span>, <span class="st">"Grass"</span>, <span class="st">"Ice"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Fire"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Rock"</span>, <span class="st">"Water"</span>, <span class="st">"Dragon"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Ground"</span>, <span class="st">"Rock"</span>, <span class="st">"Fire"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Grass"</span>, <span class="st">"Dragon"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Grass"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Ground"</span>, <span class="st">"Rock"</span>, <span class="st">"Water"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Grass"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Flying"</span>, <span class="st">"Poison"</span>, <span class="st">"Bug"</span>, <span class="st">"Steel"</span>, <span class="st">"Fire"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Electric"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Flying"</span>, <span class="st">"Water"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Electric"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-114"><a href="#cb30-114" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Ground"</span>, <span class="st">"Grass"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-115"><a href="#cb30-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-116"><a href="#cb30-116" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Psychic"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-117"><a href="#cb30-117" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Poison"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-118"><a href="#cb30-118" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Psychic"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-119"><a href="#cb30-119" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Steel"</span>, <span class="st">"Dark"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-120"><a href="#cb30-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-121"><a href="#cb30-121" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Ice"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-122"><a href="#cb30-122" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Flying"</span>, <span class="st">"Ground"</span>, <span class="st">"Grass"</span>, <span class="st">"Dragon"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-123"><a href="#cb30-123" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Ice"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-124"><a href="#cb30-124" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">'Steel'</span>, <span class="st">'Fire'</span>, <span class="st">'Water'</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-125"><a href="#cb30-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-126"><a href="#cb30-126" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Dragon"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-127"><a href="#cb30-127" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Steel"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-128"><a href="#cb30-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-129"><a href="#cb30-129" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Dark"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-130"><a href="#cb30-130" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Ghost"</span>, <span class="st">"Psychic"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-131"><a href="#cb30-131" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Dark"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-132"><a href="#cb30-132" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Fairy"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-133"><a href="#cb30-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-134"><a href="#cb30-134" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>strong[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Fairy"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-135"><a href="#cb30-135" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Fighting"</span>, <span class="st">"Dragon"</span>, <span class="st">"Dark"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-136"><a href="#cb30-136" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>weak[combats<span class="sc">$</span>First_Type <span class="sc">==</span> <span class="st">"Fairy"</span> <span class="sc">&amp;</span> combats<span class="sc">$</span>Second_Type <span class="sc">%in%</span> </span>
<span id="cb30-137"><a href="#cb30-137" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"Poison"</span>, <span class="st">"Steel"</span>, <span class="st">"Fire"</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-138"><a href="#cb30-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-139"><a href="#cb30-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-140"><a href="#cb30-140" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>first_legendary<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>First_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Legendary[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-141"><a href="#cb30-141" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>first_legendary[combats<span class="sc">$</span>first_legendary <span class="sc">==</span> <span class="st">"True"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-142"><a href="#cb30-142" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>first_legendary[combats<span class="sc">$</span>first_legendary <span class="sc">==</span> <span class="st">"False"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-143"><a href="#cb30-143" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>first_legendary <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(combats<span class="sc">$</span>first_legendary)</span>
<span id="cb30-144"><a href="#cb30-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-145"><a href="#cb30-145" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>second_legendary<span class="ot">&lt;-</span><span class="fu">sapply</span>(combats<span class="sc">$</span>Second_pokemon_name, <span class="cf">function</span>(x) pokemon<span class="sc">$</span>Legendary[<span class="fu">match</span>(x, pokemon<span class="sc">$</span>Name)])</span>
<span id="cb30-146"><a href="#cb30-146" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>second_legendary[combats<span class="sc">$</span>second_legendary <span class="sc">==</span> <span class="st">"True"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-147"><a href="#cb30-147" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>second_legendary[combats<span class="sc">$</span>second_legendary <span class="sc">==</span> <span class="st">"False"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-148"><a href="#cb30-148" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>second_legendary <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(combats<span class="sc">$</span>second_legendary)</span>
<span id="cb30-149"><a href="#cb30-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-150"><a href="#cb30-150" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>atk1_def2_diff <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_attack <span class="sc">-</span> combats<span class="sc">$</span>Second_defense</span>
<span id="cb30-151"><a href="#cb30-151" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>def1_atk2_diff <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_defense <span class="sc">-</span> combats<span class="sc">$</span>Second_attack</span>
<span id="cb30-152"><a href="#cb30-152" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>spatk1_spdef2_diff <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_sp_atk <span class="sc">-</span> combats<span class="sc">$</span>Second_sp_def</span>
<span id="cb30-153"><a href="#cb30-153" aria-hidden="true" tabindex="-1"></a>combats<span class="sc">$</span>spdef1_spatk2_diff <span class="ot">&lt;-</span> combats<span class="sc">$</span>First_sp_def <span class="sc">-</span> combats<span class="sc">$</span>Second_sp_atk</span>
<span id="cb30-154"><a href="#cb30-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-155"><a href="#cb30-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-156"><a href="#cb30-156" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fastDummies)</span>
<span id="cb30-157"><a href="#cb30-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-158"><a href="#cb30-158" aria-hidden="true" tabindex="-1"></a>type_db <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(combats[,<span class="fu">c</span>( <span class="st">"First_Type"</span> ,<span class="st">"Second_Type"</span> )],</span>
<span id="cb30-159"><a href="#cb30-159" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-160"><a href="#cb30-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-161"><a href="#cb30-161" aria-hidden="true" tabindex="-1"></a>combats <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(combats,</span>
<span id="cb30-162"><a href="#cb30-162" aria-hidden="true" tabindex="-1"></a>                      <span class="at">select_columns =</span> <span class="fu">c</span>( <span class="st">"First_Type"</span> ,<span class="st">"Second_Type"</span> ),</span>
<span id="cb30-163"><a href="#cb30-163" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-164"><a href="#cb30-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-165"><a href="#cb30-165" aria-hidden="true" tabindex="-1"></a>combats_use <span class="ot">&lt;-</span> combats[,<span class="dv">6</span><span class="sc">:</span><span class="dv">70</span>]</span>
<span id="cb30-166"><a href="#cb30-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-167"><a href="#cb30-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-168"><a href="#cb30-168" aria-hidden="true" tabindex="-1"></a>pokemon_best <span class="ot">&lt;-</span> pokemon <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pokemon<span class="sc">$</span>Speed <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">&amp;</span> </span>
<span id="cb30-169"><a href="#cb30-169" aria-hidden="true" tabindex="-1"></a>                                     pokemon<span class="sc">$</span>Attack <span class="sc">&gt;</span> <span class="dv">85</span> <span class="sc">&amp;</span> pokemon<span class="sc">$</span>HP <span class="sc">&gt;</span><span class="dv">80</span> <span class="sc">&amp;</span> </span>
<span id="cb30-170"><a href="#cb30-170" aria-hidden="true" tabindex="-1"></a>                                     pokemon<span class="sc">$</span>Legendary <span class="sc">==</span> <span class="st">'False'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Generating Train data and Test Data using Stratified Splitting</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splitstackshape)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="co"># Set seed</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform stratified sampling</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>split_data <span class="ot">&lt;-</span> <span class="fu">stratified</span>(combats, <span class="co"># Set dataset</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> <span class="st">"if_first_win"</span>, <span class="co"># Set variables to use for stratification</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">size =</span> <span class="fl">0.2</span>,  <span class="co"># Set size of test set</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">bothSets =</span> <span class="cn">TRUE</span> ) <span class="co"># Return both training and test sets</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract train data</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> split_data[[<span class="dv">2</span>]][,<span class="dv">6</span><span class="sc">:</span><span class="dv">70</span>]</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>train_names <span class="ot">&lt;-</span> split_data[[<span class="dv">2</span>]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract test data</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> split_data[[<span class="dv">1</span>]][,<span class="dv">6</span><span class="sc">:</span><span class="dv">70</span>]</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>test_names <span class="ot">&lt;-</span> split_data[[<span class="dv">1</span>]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="logistic-regression-model-fitting" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression-model-fitting">Logistic Regression Model Fitting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded glmnet 4.1-4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>logistic_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(if_first_win<span class="sc">~</span>., <span class="co"># Set formula</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">'logit'</span>), <span class="co"># Set logistic regression</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span> train_data) <span class="co"># Set dataset</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>sum_logistic <span class="ot">&lt;-</span> <span class="fu">summary</span>(logistic_model) <span class="co"># Sumamrize model</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>sum_logistic<span class="sc">$</span>coefficients[sum_logistic<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Estimate      Pr(&gt;|z|)
(Intercept)          0.353983265  5.290749e-04
First_attack         0.009233236  3.169912e-43
Second_attack       -0.009411510  1.520837e-43
First_HP             0.003626162  5.226525e-07
prop_HP             -0.025930308  7.889621e-07
First_speed          0.076186370  0.000000e+00
Second_speed        -0.076202257  0.000000e+00
prop_speed          -0.423709768 5.352650e-135
strong               0.486278535  9.341841e-25
weak                -0.646624203  3.943273e-42
First_Type_Dark      0.453149227  2.214857e-07
First_Type_Fighting -0.445184351  1.594112e-06
First_Type_Fire      0.290024947  4.030260e-05
First_Type_Ghost    -0.345038514  3.943463e-05
First_Type_Psychic  -0.291184217  5.726862e-05
Second_Type_Dark    -0.732127082  6.102756e-17
Second_Type_Ghost   -0.569136415  4.575320e-11
Second_Type_Ground  -0.543898576  2.300910e-10
Second_Type_Normal  -0.389380720  1.715652e-10
Second_Type_Steel   -0.327392384  5.195387e-04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>logistic_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logistic_model, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
prediction from a rank-deficient fit may be misleading</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plot to find the best cut-off value to minimize error</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>plot_dat <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(logistic_pred, <span class="fu">factor</span>(test_data<span class="sc">$</span>if_first_win))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(plot_dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"probability"</span>, <span class="st">"response"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>g_cutoff <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_dat, <span class="fu">aes</span>(<span class="at">x =</span> probability, <span class="at">fill =</span> response)) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="co"># Turn of the background grid</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Probability"</span>,  <span class="co"># Set plot labels</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"if_first_win"</span>,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Predicted Probabilities v Win"</span>) <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"blue"</span>), <span class="co"># Manually set fill values</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"Lose"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Win"</span>))</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate  Plot</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>g_cutoff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(logistic_pred))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>pred_class[logistic_pred <span class="sc">&gt;=</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(pred_class, test_data<span class="sc">$</span>if_first_win) <span class="co"># Create table</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(t, <span class="at">positive =</span> <span class="st">"1"</span>) <span class="co"># Produce confusion matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          
pred_class    0    1
         0 4735  587
         1  545 4133
                                          
               Accuracy : 0.8868          
                 95% CI : (0.8804, 0.8929)
    No Information Rate : 0.528           
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.7728          
                                          
 Mcnemar's Test P-Value : 0.223           
                                          
            Sensitivity : 0.8756          
            Specificity : 0.8968          
         Pos Pred Value : 0.8835          
         Neg Pred Value : 0.8897          
             Prevalence : 0.4720          
         Detection Rate : 0.4133          
   Detection Prevalence : 0.4678          
      Balanced Accuracy : 0.8862          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
</section>
<section id="random-forest-model-fitting" class="level2">
<h2 class="anchored" data-anchor-id="random-forest-model-fitting">Random Forest Model Fitting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>train_data_for_rf <span class="ot">&lt;-</span> train_data</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>train_data_for_rf<span class="sc">$</span>if_first_win <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train_data_for_rf<span class="sc">$</span>if_first_win)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>test_data_for_rf <span class="ot">&lt;-</span> test_data</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>test_data_for_rf<span class="sc">$</span>if_first_win <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test_data_for_rf<span class="sc">$</span>if_first_win)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(if_first_win<span class="sc">~</span>., <span class="co"># Set tree formula</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> train_data_for_rf, <span class="co"># Set dataset</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">500</span>) <span class="co"># Set number of trees to use</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>rf_mod</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = if_first_win ~ ., data = train_data_for_rf,      ntree = 500) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 8

        OOB estimate of  error rate: 4%
Confusion matrix:
      0     1 class.error
0 20145   974  0.04611961
1   625 18256  0.03310206</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>oob_error <span class="ot">&lt;-</span> rf_mod<span class="sc">$</span>err.rate[,<span class="dv">1</span>] <span class="co"># Extract oob error</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>plot_dat <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(oob_error)), oob_error) <span class="co"># Create plot data</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(plot_dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"trees"</span>, <span class="st">"oob_error"</span>) <span class="co"># Name plot data</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot oob error</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>g_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_dat, <span class="fu">aes</span>(<span class="at">x =</span> trees, <span class="at">y =</span> oob_error)) <span class="sc">+</span> <span class="co"># Set x as trees and y as error</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="co"># Select geom point</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="co"># Set theme</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span> <span class="co"># Add smoothing line</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove grid</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove grid</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove grid</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="co"># Remove grid </span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of Trees"</span>, <span class="at">title =</span> <span class="st">"Error Rate v Number of Trees"</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Error Rate"</span>)  <span class="co"># Set labels</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>g_1 <span class="co"># Print plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Try different values to find the best random forest</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>mtry_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">23</span>, <span class="dv">26</span>, <span class="dv">30</span>, <span class="dv">33</span>, <span class="dv">36</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>nodesize_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(mtry_vals, nodesize_vals)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(params) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mtry"</span>, <span class="st">"nodesize"</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>acc_vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(params))</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>sens_vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(params))</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(params)){</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(if_first_win<span class="sc">~</span>., <span class="co"># Set tree formula</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> train_data_for_rf, <span class="co"># Set dataset</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">150</span>,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nodesize =</span> params<span class="sc">$</span>nodesize[i],</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mtry =</span> params<span class="sc">$</span>mtry[i]) <span class="co"># Set number of trees to use</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  rf_preds <span class="ot">&lt;-</span>rf_mod<span class="sc">$</span>predicted <span class="co"># Create predictions for bagging model</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">table</span>(rf_preds,   train_data_for_rf<span class="sc">$</span>if_first_win) <span class="co"># Create table</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(t, <span class="at">positive =</span> <span class="st">"1"</span>) <span class="co"># Produce confusion matrix</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>  acc_vec[i] <span class="ot">&lt;-</span> c<span class="sc">$</span>overall[<span class="dv">1</span>]</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  sens_vec[i] <span class="ot">&lt;-</span> c<span class="sc">$</span>byClass[<span class="dv">1</span>]</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>res_db <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(params, acc_vec, sens_vec)</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>res_db<span class="sc">$</span>mtry <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(res_db<span class="sc">$</span>mtry) <span class="co"># Convert tree number to factor for plotting</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>res_db<span class="sc">$</span>nodesize <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(res_db<span class="sc">$</span>nodesize) <span class="co"># Convert node size to factor for plotting</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>g_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(res_db, <span class="fu">aes</span>(<span class="at">y =</span> mtry, <span class="at">x =</span> nodesize, <span class="at">fill =</span> acc_vec)) <span class="sc">+</span> <span class="co"># set aesthetics</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="co"># Use geom_tile for heatmap</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="co"># Set theme</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="co"># Choose low color</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid =</span> <span class="st">"white"</span>, <span class="co"># Choose mid color</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">high =</span> <span class="st">"red"</span>, <span class="co"># Choose high color</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span><span class="fu">mean</span>(res_db<span class="sc">$</span>acc_vec), <span class="co"># Choose mid point</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">space =</span> <span class="st">"Lab"</span>, </span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">na.value =</span><span class="st">"grey"</span>, <span class="co"># Choose NA value</span></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">"colourbar"</span>, <span class="co"># Set color bar</span></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>                       <span class="at">aesthetics =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="co"># Select aesthetics to apply</span></span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Node Size"</span>, <span class="at">y =</span> <span class="st">"mtry"</span>, <span class="at">fill =</span> <span class="st">"OOB Accuracy"</span>) <span class="co"># Set labels</span></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>g_1 <span class="co"># Generate plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>g_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(res_db, <span class="fu">aes</span>(<span class="at">y =</span> mtry, <span class="at">x =</span> nodesize, <span class="at">fill =</span> sens_vec)) <span class="sc">+</span> <span class="co"># set aesthetics</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="co"># Use geom_tile for heatmap</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="co"># Set theme</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="co"># Choose low color</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid =</span> <span class="st">"white"</span>, <span class="co"># Choose mid color</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">high =</span> <span class="st">"red"</span>, <span class="co"># Choose high color</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span><span class="fu">mean</span>(res_db<span class="sc">$</span>sens_vec), <span class="co"># Choose mid point</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">space =</span> <span class="st">"Lab"</span>, </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">na.value =</span><span class="st">"grey"</span>, <span class="co"># Choose NA value</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">"colourbar"</span>, <span class="co"># Set color bar</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">aesthetics =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="co"># Select aesthetics to apply</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Node Size"</span>, <span class="at">y =</span> <span class="st">"Mtry"</span>, <span class="at">fill =</span> <span class="st">"OOB Sensitivity"</span>) <span class="co"># Set labels</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>g_2 <span class="co"># Generate plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>res_db[<span class="fu">which</span>(res_db<span class="sc">$</span>nodesize <span class="sc">==</span> <span class="dv">1</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mtry nodesize  acc_vec  sens_vec
1   20        1 0.968475 0.9724591
2   23        1 0.968325 0.9718765
3   26        1 0.969425 0.9728298
4   30        1 0.969675 0.9734654
5   33        1 0.969775 0.9734654
6   36        1 0.969625 0.9729358</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(<span class="fu">factor</span>(if_first_win)<span class="sc">~</span>., <span class="co"># Set tree formula</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> train_data_for_rf, <span class="co"># Set dataset</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">150</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nodesize =</span> <span class="dv">1</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mtry =</span> <span class="dv">33</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>rf_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data, <span class="at">type =</span> <span class="st">"prob"</span>) <span class="co"># Create predictions for random forest model</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert predictions to classes, using 0.5</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>rf_pred_class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(rf_preds))</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>rf_pred_class[rf_preds[,<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(rf_pred_class, test_data<span class="sc">$</span>if_first_win) <span class="co"># Create table</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(t, <span class="at">positive =</span> <span class="st">"1"</span>) <span class="co"># Produce confusion matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

             
rf_pred_class    0    1
            0 5120  115
            1  160 4605
                                          
               Accuracy : 0.9725          
                 95% CI : (0.9691, 0.9756)
    No Information Rate : 0.528           
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.9449          
                                          
 Mcnemar's Test P-Value : 0.007971        
                                          
            Sensitivity : 0.9756          
            Specificity : 0.9697          
         Pos Pred Value : 0.9664          
         Neg Pred Value : 0.9780          
             Prevalence : 0.4720          
         Detection Rate : 0.4605          
   Detection Prevalence : 0.4765          
      Balanced Accuracy : 0.9727          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
</section>
<section id="xgboost-model-fitting" class="level2">
<h2 class="anchored" data-anchor-id="xgboost-model-fitting">XGBoost Model Fitting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'xgboost'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    slice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>dtrain <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(train_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">64</span>]), <span class="at">label =</span> train_data<span class="sc">$</span>if_first_win)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create test matrix</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>dtest <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(test_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">64</span>]), <span class="at">label =</span> test_data<span class="sc">$</span>if_first_win)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>bst_mod_cv <span class="ot">&lt;-</span> <span class="fu">xgb.cv</span>(<span class="at">data =</span> dtrain, <span class="co"># Set training data</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nfold =</span> <span class="dv">5</span>, <span class="co"># Use 5 fold cross-validation</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">eta =</span> <span class="fl">0.1</span>, <span class="co"># Set learning rate</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nrounds =</span> <span class="dv">400</span>, <span class="co"># Set number of rounds</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">early_stopping_rounds =</span> <span class="dv">20</span>, <span class="co"># Set number of rounds to stop at if</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verbose =</span> <span class="dv">1</span>, <span class="co"># 1 - Prints out fit</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nthread =</span> <span class="dv">1</span>, <span class="co"># Set number of parallel threads</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">print_every_n =</span> <span class="dv">20</span>, <span class="co"># Prints out result every 20th iteration</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">objective =</span> <span class="st">"binary:logistic"</span>, <span class="co"># Set objective</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">eval_metric =</span> <span class="st">"auc"</span>,</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">eval_metric =</span> <span class="st">"error"</span>) <span class="co"># Set evaluation metric to use</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] train-auc:0.977583+0.000993 train-error:0.040362+0.001170   test-auc:0.975792+0.001988  test-error:0.044050+0.002732 
Multiple eval metrics are present. Will use test_error for early stopping.
Will train until test_error hasn't improved in 20 rounds.

[21]    train-auc:0.989935+0.000246 train-error:0.032256+0.000557   test-auc:0.987172+0.001802  test-error:0.038600+0.002497 
[41]    train-auc:0.994173+0.000133 train-error:0.028387+0.000437   test-auc:0.990694+0.001249  test-error:0.036250+0.002462 
[61]    train-auc:0.995885+0.000096 train-error:0.024756+0.000470   test-auc:0.991676+0.001119  test-error:0.034250+0.002813 
[81]    train-auc:0.996854+0.000070 train-error:0.022163+0.000290   test-auc:0.992262+0.001168  test-error:0.033250+0.003130 
[101]   train-auc:0.997620+0.000085 train-error:0.019844+0.000240   test-auc:0.992705+0.001046  test-error:0.032575+0.003120 
[121]   train-auc:0.998111+0.000068 train-error:0.018094+0.000240   test-auc:0.992937+0.000979  test-error:0.031975+0.003054 
[141]   train-auc:0.998510+0.000076 train-error:0.016306+0.000302   test-auc:0.993049+0.000925  test-error:0.031625+0.003065 
Stopping. Best iteration:
[136]   train-auc:0.998423+0.000067 train-error:0.016681+0.000243   test-auc:0.993065+0.000934  test-error:0.031300+0.002895</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(bst_mod_cv<span class="sc">$</span>evaluation_log[,<span class="fu">c</span>(<span class="st">"iter"</span>, <span class="st">"test_error_mean"</span>)], <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="fu">nrow</span>(bst_mod_cv<span class="sc">$</span>evaluation_log)))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pd)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"eta"</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(pd)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>eta <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(plot_data<span class="sc">$</span>eta)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>g_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> iter, <span class="at">y =</span> test_error_mean))<span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="co"># Set theme</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove grid</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove grid</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove grid</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="co"># Remove grid </span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of Trees"</span>, <span class="at">title =</span> <span class="st">"Error Rate v Number of Trees"</span>,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Error Rate"</span>, <span class="at">color =</span> <span class="st">"Learning </span><span class="sc">\n</span><span class="st"> Rate"</span>)  <span class="co"># Set labels</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>g_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>bst_mod_1 <span class="ot">&lt;-</span> <span class="fu">xgb.cv</span>(<span class="at">data =</span> dtrain, <span class="co"># Set training data</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nfold =</span> <span class="dv">5</span>, <span class="co"># Use 5 fold cross-validation</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eta =</span> <span class="fl">0.1</span>, <span class="co"># Set learning rate</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nrounds =</span> <span class="dv">150</span>, <span class="co"># Set number of rounds</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">early_stopping_rounds =</span> <span class="dv">20</span>, <span class="co"># Set number of rounds to stop at if</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> <span class="dv">1</span>, <span class="co"># 1 - Prints out fit</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nthread =</span> <span class="dv">1</span>, <span class="co"># Set number of parallel threads</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">print_every_n =</span> <span class="dv">20</span>, <span class="co"># Prints out result every 20th iteration</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">objective =</span> <span class="st">"binary:logistic"</span>, <span class="co"># Set objective</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eval_metric =</span> <span class="st">"auc"</span>,</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eval_metric =</span> <span class="st">"error"</span>) <span class="co"># Set evaluation metric to use</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] train-auc:0.977638+0.000644 train-error:0.040531+0.000869   test-auc:0.976123+0.001838  test-error:0.043925+0.001523 
Multiple eval metrics are present. Will use test_error for early stopping.
Will train until test_error hasn't improved in 20 rounds.

[21]    train-auc:0.989770+0.000191 train-error:0.032775+0.000253   test-auc:0.987475+0.000810  test-error:0.038025+0.001875 
[41]    train-auc:0.994227+0.000462 train-error:0.028644+0.000541   test-auc:0.990758+0.000583  test-error:0.035800+0.001171 
[61]    train-auc:0.996022+0.000203 train-error:0.025000+0.000435   test-auc:0.992003+0.000889  test-error:0.034025+0.001280 
[81]    train-auc:0.997046+0.000160 train-error:0.022025+0.000174   test-auc:0.992454+0.000942  test-error:0.033075+0.001682 
[101]   train-auc:0.997691+0.000148 train-error:0.019744+0.000364   test-auc:0.992712+0.000981  test-error:0.032500+0.001755 
[121]   train-auc:0.998201+0.000114 train-error:0.017713+0.000427   test-auc:0.992914+0.001024  test-error:0.032000+0.001536 
[141]   train-auc:0.998554+0.000109 train-error:0.016087+0.000557   test-auc:0.993070+0.000983  test-error:0.031925+0.001705 
[150]   train-auc:0.998688+0.000115 train-error:0.015400+0.000545   test-auc:0.993126+0.000981  test-error:0.031800+0.001738 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>bst_mod_2 <span class="ot">&lt;-</span> <span class="fu">xgb.cv</span>(<span class="at">data =</span> dtrain, <span class="co"># Set training data</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nfold =</span> <span class="dv">5</span>, <span class="co"># Use 5 fold cross-validation</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eta =</span> <span class="fl">0.05</span>, <span class="co"># Set learning rate</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nrounds =</span> <span class="dv">150</span>, <span class="co"># Set number of rounds</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">early_stopping_rounds =</span> <span class="dv">20</span>, <span class="co"># Set number of rounds to stop at if</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> <span class="dv">1</span>, <span class="co"># 1 - Prints out fit</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nthread =</span> <span class="dv">1</span>, <span class="co"># Set number of parallel threads</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">print_every_n =</span> <span class="dv">20</span>, <span class="co"># Prints out result every 20th iteration</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">objective =</span> <span class="st">"binary:logistic"</span>, <span class="co"># Set objective</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eval_metric =</span> <span class="st">"auc"</span>,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eval_metric =</span> <span class="st">"error"</span>) <span class="co"># Set evaluation metric to use</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] train-auc:0.977352+0.001028 train-error:0.040750+0.000803   test-auc:0.975521+0.001694  test-error:0.044325+0.002489 
Multiple eval metrics are present. Will use test_error for early stopping.
Will train until test_error hasn't improved in 20 rounds.

[21]    train-auc:0.986591+0.000693 train-error:0.035363+0.000323   test-auc:0.984653+0.000849  test-error:0.039500+0.001735 
[41]    train-auc:0.990029+0.000574 train-error:0.032950+0.000734   test-auc:0.987602+0.000577  test-error:0.038100+0.002477 
[61]    train-auc:0.992603+0.000271 train-error:0.030931+0.000598   test-auc:0.989740+0.000875  test-error:0.037150+0.002529 
[81]    train-auc:0.994030+0.000251 train-error:0.028825+0.000499   test-auc:0.990765+0.001015  test-error:0.036450+0.002252 
[101]   train-auc:0.995104+0.000250 train-error:0.026906+0.000649   test-auc:0.991400+0.001095  test-error:0.034725+0.001864 
[121]   train-auc:0.995863+0.000190 train-error:0.025144+0.000519   test-auc:0.991828+0.000975  test-error:0.033975+0.001633 
[141]   train-auc:0.996447+0.000139 train-error:0.023656+0.000717   test-auc:0.992163+0.000782  test-error:0.033225+0.001452 
[150]   train-auc:0.996689+0.000121 train-error:0.023050+0.000817   test-auc:0.992279+0.000753  test-error:0.032975+0.001386 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>bst_mod_3 <span class="ot">&lt;-</span> <span class="fu">xgb.cv</span>(<span class="at">data =</span> dtrain, <span class="co"># Set training data</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nfold =</span> <span class="dv">5</span>, <span class="co"># Use 5 fold cross-validation</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eta =</span> <span class="fl">0.3</span>, <span class="co"># Set learning rate</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nrounds =</span> <span class="dv">150</span>, <span class="co"># Set number of rounds</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">early_stopping_rounds =</span> <span class="dv">20</span>, <span class="co"># Set number of rounds to stop at if</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> <span class="dv">1</span>, <span class="co"># 1 - Prints out fit</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nthread =</span> <span class="dv">1</span>, <span class="co"># Set number of parallel threads</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">print_every_n =</span> <span class="dv">20</span>, <span class="co"># Prints out result every 20th iteration</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">objective =</span> <span class="st">"binary:logistic"</span>, <span class="co"># Set objective</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eval_metric =</span> <span class="st">"auc"</span>,</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eval_metric =</span> <span class="st">"error"</span>) <span class="co"># Set evaluation metric to use</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] train-auc:0.978080+0.000623 train-error:0.040081+0.000547   test-auc:0.976091+0.001212  test-error:0.043825+0.000977 
Multiple eval metrics are present. Will use test_error for early stopping.
Will train until test_error hasn't improved in 20 rounds.

[21]    train-auc:0.995853+0.000303 train-error:0.024144+0.000359   test-auc:0.991519+0.001209  test-error:0.033925+0.000510 
[41]    train-auc:0.998125+0.000089 train-error:0.017394+0.000160   test-auc:0.992479+0.001175  test-error:0.032225+0.000599 
[61]    train-auc:0.999168+0.000069 train-error:0.012006+0.000380   test-auc:0.992652+0.001179  test-error:0.031550+0.000970 
[81]    train-auc:0.999624+0.000036 train-error:0.008150+0.000659   test-auc:0.992808+0.001102  test-error:0.030750+0.000597 
[101]   train-auc:0.999837+0.000010 train-error:0.005300+0.000299   test-auc:0.992743+0.001171  test-error:0.030950+0.000777 
Stopping. Best iteration:
[85]    train-auc:0.999681+0.000032 train-error:0.007487+0.000519   test-auc:0.992799+0.001129  test-error:0.030625+0.000771</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>bst_mod_4 <span class="ot">&lt;-</span> <span class="fu">xgb.cv</span>(<span class="at">data =</span> dtrain, <span class="co"># Set training data</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nfold =</span> <span class="dv">5</span>, <span class="co"># Use 5 fold cross-validation</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eta =</span> <span class="fl">0.01</span>, <span class="co"># Set learning rate</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nrounds =</span> <span class="dv">150</span>, <span class="co"># Set number of rounds</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">early_stopping_rounds =</span> <span class="dv">20</span>, <span class="co"># Set number of rounds to stop at if</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> <span class="dv">1</span>, <span class="co"># 1 - Prints out fit</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nthread =</span> <span class="dv">1</span>, <span class="co"># Set number of parallel threads</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">print_every_n =</span> <span class="dv">20</span>, <span class="co"># Prints out result every 20th iteration</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">objective =</span> <span class="st">"binary:logistic"</span>, <span class="co"># Set objective</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eval_metric =</span> <span class="st">"auc"</span>,</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eval_metric =</span> <span class="st">"error"</span>) <span class="co"># Set evaluation metric to use</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] train-auc:0.977358+0.001106 train-error:0.040719+0.001319   test-auc:0.975089+0.001179  test-error:0.044425+0.001493 
Multiple eval metrics are present. Will use test_error for early stopping.
Will train until test_error hasn't improved in 20 rounds.

[21]    train-auc:0.981727+0.001605 train-error:0.039062+0.001204   test-auc:0.979480+0.002059  test-error:0.043000+0.001589 
[41]    train-auc:0.983802+0.000990 train-error:0.038269+0.001326   test-auc:0.981577+0.000810  test-error:0.042400+0.001935 
[61]    train-auc:0.985262+0.000684 train-error:0.037244+0.001514   test-auc:0.983343+0.000710  test-error:0.041950+0.001941 
[81]    train-auc:0.986002+0.000543 train-error:0.036419+0.001447   test-auc:0.984094+0.001017  test-error:0.040475+0.001985 
[101]   train-auc:0.986804+0.000505 train-error:0.035906+0.001373   test-auc:0.984862+0.001038  test-error:0.040250+0.001992 
[121]   train-auc:0.987549+0.000349 train-error:0.035337+0.001162   test-auc:0.985525+0.001108  test-error:0.039775+0.001846 
[141]   train-auc:0.988103+0.000260 train-error:0.034637+0.001121   test-auc:0.986068+0.001046  test-error:0.039400+0.001913 
[150]   train-auc:0.988337+0.000305 train-error:0.034400+0.001109   test-auc:0.986245+0.001001  test-error:0.039125+0.002051 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>bst_mod_5 <span class="ot">&lt;-</span> <span class="fu">xgb.cv</span>(<span class="at">data =</span> dtrain, <span class="co"># Set training data</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nfold =</span> <span class="dv">5</span>, <span class="co"># Use 5 fold cross-validation</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eta =</span> <span class="fl">0.5</span>, <span class="co"># Set learning rate</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nrounds =</span> <span class="dv">150</span>, <span class="co"># Set number of rounds</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">early_stopping_rounds =</span> <span class="dv">20</span>, <span class="co"># Set number of rounds to stop at if</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> <span class="dv">1</span>, <span class="co"># 1 - Prints out fit</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nthread =</span> <span class="dv">1</span>, <span class="co"># Set number of parallel threads</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">print_every_n =</span> <span class="dv">20</span>, <span class="co"># Prints out result every 20th iteration</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">objective =</span> <span class="st">"binary:logistic"</span>, <span class="co"># Set objective</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eval_metric =</span> <span class="st">"auc"</span>,</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eval_metric =</span> <span class="st">"error"</span>) <span class="co"># Set evaluation metric to use</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] train-auc:0.977366+0.001020 train-error:0.039887+0.000318   test-auc:0.975561+0.000898  test-error:0.043925+0.001590 
Multiple eval metrics are present. Will use test_error for early stopping.
Will train until test_error hasn't improved in 20 rounds.

[21]    train-auc:0.997508+0.000067 train-error:0.019806+0.000518   test-auc:0.992007+0.000744  test-error:0.033925+0.001317 
[41]    train-auc:0.999348+0.000093 train-error:0.010719+0.000334   test-auc:0.992784+0.000618  test-error:0.033075+0.001764 
[61]    train-auc:0.999835+0.000025 train-error:0.005194+0.000302   test-auc:0.992925+0.000750  test-error:0.032900+0.001357 
[81]    train-auc:0.999972+0.000006 train-error:0.001825+0.000170   test-auc:0.992974+0.000689  test-error:0.032150+0.001051 
[101]   train-auc:0.999997+0.000001 train-error:0.000525+0.000130   test-auc:0.993057+0.000723  test-error:0.032200+0.001245 
Stopping. Best iteration:
[98]    train-auc:0.999995+0.000002 train-error:0.000619+0.000150   test-auc:0.993032+0.000744  test-error:0.031850+0.001072</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>pd1 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(bst_mod_1<span class="sc">$</span>evaluation_log[,<span class="fu">c</span>(<span class="st">"iter"</span>, <span class="st">"test_error_mean"</span>)], <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="fu">nrow</span>(bst_mod_1<span class="sc">$</span>evaluation_log)))</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pd1)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"eta"</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract results for model with eta = 0.1</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>pd2 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(bst_mod_2<span class="sc">$</span>evaluation_log[,<span class="fu">c</span>(<span class="st">"iter"</span>, <span class="st">"test_error_mean"</span>)], <span class="fu">rep</span>(<span class="fl">0.05</span>, <span class="fu">nrow</span>(bst_mod_2<span class="sc">$</span>evaluation_log)))</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pd2)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"eta"</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract results for model with eta = 0.05</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>pd3 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(bst_mod_3<span class="sc">$</span>evaluation_log[,<span class="fu">c</span>(<span class="st">"iter"</span>, <span class="st">"test_error_mean"</span>)], <span class="fu">rep</span>(<span class="fl">0.3</span>, <span class="fu">nrow</span>(bst_mod_3<span class="sc">$</span>evaluation_log)))</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pd3)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"eta"</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract results for model with eta = 0.01</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>pd4 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(bst_mod_4<span class="sc">$</span>evaluation_log[,<span class="fu">c</span>(<span class="st">"iter"</span>, <span class="st">"test_error_mean"</span>)], <span class="fu">rep</span>(<span class="fl">0.01</span>, <span class="fu">nrow</span>(bst_mod_4<span class="sc">$</span>evaluation_log)))</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pd4)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"eta"</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract results for model with eta = 0.005</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>pd5 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(bst_mod_5<span class="sc">$</span>evaluation_log[,<span class="fu">c</span>(<span class="st">"iter"</span>, <span class="st">"test_error_mean"</span>)], <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="fu">nrow</span>(bst_mod_5<span class="sc">$</span>evaluation_log)))</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pd5)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"eta"</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Join datasets</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(pd1, pd2, pd3, pd4, pd5)</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Converty ETA to factor</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>eta <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(plot_data<span class="sc">$</span>eta)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>g_eta <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> iter, <span class="at">y =</span> test_error_mean, <span class="at">color =</span> eta))<span class="sc">+</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="co"># Set theme</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove grid</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove grid</span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove grid</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="co"># Remove grid </span></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of Trees"</span>, <span class="at">title =</span> <span class="st">"Error Rate v Number of Trees"</span>,</span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Error Rate"</span>, <span class="at">color =</span> <span class="st">"Learning </span><span class="sc">\n</span><span class="st"> Rate"</span>)  <span class="co"># Set labels</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>g_eta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>best_bst_mod <span class="ot">&lt;-</span> <span class="fu">xgboost</span>(<span class="at">data =</span> dtrain, <span class="co"># Set training data</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">eta =</span> <span class="fl">0.3</span>, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">nrounds =</span> <span class="dv">130</span>, <span class="co"># Set number of rounds</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">verbose =</span> <span class="dv">1</span>, <span class="co"># 1 - Prints out fit</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">print_every_n =</span> <span class="dv">20</span>, <span class="co"># Prints out result every 20th iteration</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">objective =</span> <span class="st">"binary:logistic"</span>, <span class="co"># Set objective</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">eval_metric =</span> <span class="st">"auc"</span>,</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">eval_metric =</span> <span class="st">"error"</span>) <span class="co"># Set evaluation metric to use</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] train-auc:0.976882  train-error:0.040275 
[21]    train-auc:0.995800  train-error:0.024550 
[41]    train-auc:0.997929  train-error:0.018600 
[61]    train-auc:0.999002  train-error:0.013700 
[81]    train-auc:0.999450  train-error:0.009650 
[101]   train-auc:0.999713  train-error:0.006675 
[121]   train-auc:0.999874  train-error:0.004275 
[130]   train-auc:0.999918  train-error:0.003500 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>boost_preds_2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_bst_mod, dtest) <span class="co"># Create predictions for xgboost model</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert predictions to classes, using optimal cut-off</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>boost_pred_class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(boost_preds_2))</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>boost_pred_class[boost_preds_2 <span class="sc">&gt;=</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>boost_pred_class[boost_preds_2 <span class="sc">&lt;</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(boost_pred_class, test_data<span class="sc">$</span>if_first_win) <span class="co"># Create table</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(t, <span class="at">positive =</span> <span class="st">"1"</span>) <span class="co"># Produce confusion matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

                
boost_pred_class    0    1
               0 5122  120
               1  158 4600
                                          
               Accuracy : 0.9722          
                 95% CI : (0.9688, 0.9753)
    No Information Rate : 0.528           
    P-Value [Acc &gt; NIR] : &lt; 2e-16         
                                          
                  Kappa : 0.9442          
                                          
 Mcnemar's Test P-Value : 0.02648         
                                          
            Sensitivity : 0.9746          
            Specificity : 0.9701          
         Pos Pred Value : 0.9668          
         Neg Pred Value : 0.9771          
             Prevalence : 0.4720          
         Detection Rate : 0.4600          
   Detection Prevalence : 0.4758          
      Balanced Accuracy : 0.9723          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
</section>
<section id="bagging-model-fitting" class="level2">
<h2 class="anchored" data-anchor-id="bagging-model-fitting">Bagging Model Fitting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>bag_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(if_first_win<span class="sc">~</span>., <span class="co"># Set tree formula</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> train_data_for_rf,</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mtry =</span> <span class="dv">63</span>,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ntree =</span> <span class="dv">150</span>) <span class="co"># Set number of trees to use) # Set number of trees to use</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>bag_mod <span class="co"># View model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = if_first_win ~ ., data = train_data_for_rf,      mtry = 63, ntree = 150) 
               Type of random forest: classification
                     Number of trees: 150
No. of variables tried at each split: 63

        OOB estimate of  error rate: 3.05%
Confusion matrix:
      0     1 class.error
0 20415   704  0.03333491
1   516 18365  0.02732906</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>bag_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(bag_mod, test_data, <span class="at">type =</span> <span class="st">"prob"</span>) <span class="co"># Create predictions for xgboost model</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>boost_pred_class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(bag_preds[,<span class="dv">2</span>]))</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>boost_pred_class[bag_preds[,<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>boost_pred_class[bag_preds[,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">table</span>(boost_pred_class, test_data<span class="sc">$</span>if_first_win) <span class="co"># Create table</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(t, <span class="at">positive =</span> <span class="st">"1"</span>) <span class="co"># Produce confusion matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

                
boost_pred_class    0    1
               0 5126  119
               1  154 4601
                                          
               Accuracy : 0.9727          
                 95% CI : (0.9693, 0.9758)
    No Information Rate : 0.528           
    P-Value [Acc &gt; NIR] : &lt; 2e-16         
                                          
                  Kappa : 0.9452          
                                          
 Mcnemar's Test P-Value : 0.03961         
                                          
            Sensitivity : 0.9748          
            Specificity : 0.9708          
         Pos Pred Value : 0.9676          
         Neg Pred Value : 0.9773          
             Prevalence : 0.4720          
         Detection Rate : 0.4601          
   Detection Prevalence : 0.4755          
      Balanced Accuracy : 0.9728          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
</section>
<section id="roc-auc-comparison-between-logistic-regression-random-forest-xgboost-and-bagging" class="level2">
<h2 class="anchored" data-anchor-id="roc-auc-comparison-between-logistic-regression-random-forest-xgboost-and-bagging">ROC/ AUC Comparison between Logistic Regression, Random Forest, XGBoost and Bagging</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>roc1 <span class="ot">=</span> <span class="fu">roc</span>(<span class="fu">factor</span>(test_data<span class="sc">$</span>if_first_win), bag_preds[,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>roc2 <span class="ot">=</span> <span class="fu">roc</span>(<span class="fu">factor</span>(test_data<span class="sc">$</span>if_first_win), rf_preds[,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1
Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>roc3 <span class="ot">=</span> <span class="fu">roc</span>(<span class="fu">factor</span>(test_data<span class="sc">$</span>if_first_win), boost_preds_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1
Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>roc4 <span class="ot">=</span> <span class="fu">roc</span>(<span class="fu">factor</span>(test_data<span class="sc">$</span>if_first_win), logistic_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1
Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.roc</span>(roc1, <span class="at">print.auc =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">print.auc.col =</span> <span class="st">"red"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.roc</span>(roc2, <span class="at">print.auc =</span> <span class="cn">TRUE</span>, <span class="at">print.auc.y =</span> <span class="fl">0.6</span>, <span class="at">col =</span><span class="st">"blue"</span>, <span class="at">print.auc.col =</span> <span class="st">"blue"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.roc</span>(roc3, <span class="at">print.auc =</span> <span class="cn">TRUE</span>, <span class="at">print.auc.y =</span> <span class="fl">0.4</span>, <span class="at">col =</span><span class="st">"green"</span>, <span class="at">print.auc.col =</span> <span class="st">"green"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.roc</span>(roc4, <span class="at">print.auc =</span> <span class="cn">TRUE</span>, <span class="at">print.auc.y =</span> <span class="fl">0.2</span>, <span class="at">col =</span><span class="st">"black"</span>, <span class="at">print.auc.col =</span> <span class="st">"black"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="feature-variable-importance-plots" class="level2">
<h2 class="anchored" data-anchor-id="feature-variable-importance-plots">Feature (Variable) Importance Plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract importance</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>imp_mat <span class="ot">&lt;-</span> <span class="fu">xgb.importance</span>(<span class="at">model =</span> best_bst_mod)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot importance (top 10 variables)</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xgb.plot.importance</span>(imp_mat, <span class="at">top_n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/Downloads/a_insights_shap_functions.r"</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>shap_result <span class="ot">&lt;-</span> <span class="fu">shap.score.rank</span>(<span class="at">xgb_model =</span> best_bst_mod, </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">X_train =</span> <span class="fu">as.matrix</span>(train_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">64</span>]),</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">shap_approx =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: data.table</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, first, last</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>make SHAP score by decreasing order</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var_importance</span>(shap_result, <span class="at">top_n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>shap_long <span class="ot">=</span> <span class="fu">shap.prep</span>(<span class="at">shap =</span> shap_result,</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">X_train =</span> <span class="fu">as.matrix</span>(train_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">64</span>]), </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">top_n =</span> <span class="dv">10</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.shap.summary</span>(<span class="at">data_long =</span> shap_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">################ Lasso</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>train_data_scaled <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(train_data[,<span class="sc">-</span><span class="dv">1</span>])) </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>train_data_scaled<span class="sc">$</span>if_first_win <span class="ot">&lt;-</span> train_data<span class="sc">$</span>if_first_win</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotmo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Formula</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: plotrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: TeachingDemos</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> train_data_scaled[, <span class="sc">-</span><span class="dv">65</span>], <span class="co"># Fit explanatory variables</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> train_data_scaled<span class="sc">$</span>if_first_win, <span class="co"># Fit response variable</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="dv">1</span>, <span class="co"># Set alpha as 1 for lasso</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">lambda =</span> <span class="fl">0.015</span>) </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>lasso_fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> train_data_scaled[, <span class="sc">-</span><span class="dv">65</span>], <span class="co"># Fit explanatory variables</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> train_data_scaled<span class="sc">$</span>if_first_win, <span class="co"># Set response variable</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="dv">1</span>, <span class="co"># Set alpha value</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glmnet</span>(lasso_fit, <span class="co"># Plot lasso coefficients by lambda</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">xvar =</span> <span class="st">"lambda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>65 x 1 sparse Matrix of class "dgCMatrix"
                              s0
(Intercept)          -0.21126947
First_attack          .         
Second_attack         .         
diff_atk              0.32657194
First_HP              .         
Second_HP             .         
diff_HP               0.01255489
prop_HP               .         
First_defense         .         
Second_defense        .         
diff_def              .         
First_sp_atk          .         
Second_sp_atk         .         
diff_sp_atk           .         
First_sp_def          .         
Second_sp_def         .         
diff_sp_def           .         
First_speed           .         
Second_speed          .         
diff_speed            2.25740922
prop_speed            .         
strong                0.05695592
weak                 -0.07954508
first_legendary       .         
second_legendary      .         
atk1_def2_diff        0.01332198
def1_atk2_diff        .         
spatk1_spdef2_diff    .         
spdef1_spatk2_diff    .         
First_Type_Bug        .         
First_Type_Dark       .         
First_Type_Dragon     .         
First_Type_Electric   .         
First_Type_Fairy      .         
First_Type_Fighting   .         
First_Type_Fire       .         
First_Type_Flying     .         
First_Type_Ghost      .         
First_Type_Grass      .         
First_Type_Ground     .         
First_Type_Ice        .         
First_Type_Normal     .         
First_Type_Poison     .         
First_Type_Psychic    .         
First_Type_Rock       .         
First_Type_Steel      .         
First_Type_Water      .         
Second_Type_Bug       .         
Second_Type_Dark      .         
Second_Type_Dragon    .         
Second_Type_Electric  .         
Second_Type_Fairy     .         
Second_Type_Fighting  .         
Second_Type_Fire      .         
Second_Type_Flying    .         
Second_Type_Ghost     .         
Second_Type_Grass     .         
Second_Type_Ground    .         
Second_Type_Ice       .         
Second_Type_Normal    .         
Second_Type_Poison    .         
Second_Type_Psychic   .         
Second_Type_Rock      .         
Second_Type_Steel     .         
Second_Type_Water     .         </code></pre>
</div>
</div>
</section>
<section id="radar-chart" class="level2">
<h2 class="anchored" data-anchor-id="radar-chart">Radar Chart</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fmsb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'fmsb':
  method    from
  print.roc pROC
  plot.roc  pROC</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'fmsb'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:pROC':

    roc</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="do">##1</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>mega_Ven <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">130</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">80</span>, <span class="dv">123</span>, <span class="dv">122</span>, <span class="dv">120</span>, <span class="dv">80</span>)))</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mega_Ven) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Attack Force: 100"</span>, <span class="st">"Health Points: 80"</span>, <span class="st">"Defense Points: 123"</span>, </span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Sp.Attack Points: 122"</span>,<span class="st">"Sp.Defense Points: 120"</span>, <span class="st">"Speed: 80"</span>)</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="fu">radarchart</span>(mega_Ven, <span class="at">cglty =</span> <span class="dv">1</span>, <span class="at">cglcol =</span> <span class="st">"gray"</span>,</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">pcol =</span> <span class="dv">4</span>, <span class="at">plwd =</span> <span class="dv">2</span>,</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">pfcol =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="fl">0.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">##2</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>suicune <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">130</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">100</span>, <span class="dv">115</span>, <span class="dv">90</span>, <span class="dv">115</span>, <span class="dv">85</span>)))</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(suicune) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Attack Force: 75"</span>, <span class="st">"Health Points: 100"</span>, <span class="st">"Defense Points: 115"</span>, </span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Sp.Attack Points: 90"</span>,<span class="st">"Sp.Defense Points: 115"</span>, <span class="st">"Speed: 85"</span>)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="fu">radarchart</span>(suicune, <span class="at">cglty =</span> <span class="dv">1</span>, <span class="at">cglcol =</span> <span class="st">"gray"</span>,</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">pcol =</span> <span class="dv">2</span>, <span class="at">plwd =</span> <span class="dv">2</span>,</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">pfcol =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="do">##3</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>Aurorus <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">130</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">c</span>(<span class="dv">77</span>, <span class="dv">123</span>, <span class="dv">72</span>, <span class="dv">99</span>, <span class="dv">92</span>, <span class="dv">58</span>)))</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Aurorus) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Attack Force: 77"</span>, <span class="st">"Health Points: 123"</span>, <span class="st">"Defense Points: 72"</span>, </span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Sp.Attack Points: 99"</span>,<span class="st">"Sp.Defense Points: 92"</span>, <span class="st">"Speed: 58"</span>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="fu">radarchart</span>(Aurorus, <span class="at">cglty =</span> <span class="dv">1</span>, <span class="at">cglcol =</span> <span class="st">"gray"</span>,</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">pcol =</span> <span class="dv">4</span>, <span class="at">plwd =</span> <span class="dv">2</span>,</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">pfcol =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="fl">0.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="do">##4</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>Charizard <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">130</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="dv">84</span>, <span class="dv">78</span>, <span class="dv">78</span>, <span class="dv">109</span>, <span class="dv">85</span>, <span class="dv">100</span>)))</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Charizard) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Attack Force: 84"</span>, <span class="st">"Health Points: 78"</span>, <span class="st">"Defense Points: 78"</span>, </span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Sp.Attack Points: 109"</span>,<span class="st">"Sp.Defense Points: 85"</span>, <span class="st">"Speed: 100"</span>)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="fu">radarchart</span>(Charizard, <span class="at">cglty =</span> <span class="dv">1</span>, <span class="at">cglcol =</span> <span class="st">"gray"</span>,</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">pcol =</span> <span class="dv">2</span>, <span class="at">plwd =</span> <span class="dv">2</span>,</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">pfcol =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pokemon-Final-Project_files/figure-html/unnamed-chunk-20-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>
